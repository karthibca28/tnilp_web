<!-- Common Header -->
<app-common-header></app-common-header>

<div class="survey-results-container">
  <!-- Header Section -->
  <div class="results-header">
    <div class="header-content">
      <div class="header-left">
      <button type="button" class="back-button" (click)="onBackToDashboard()">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Back to Dashboard
      </button>
        <div class="survey-info">
          <h1 class="survey-title">How satisfied are you with our services?</h1>
          <p class="survey-subtitle">Citizen Satisfaction Survey - 1,250 responses</p>
        </div>
      </div>
      <div class="header-right">
        <button type="button" class="export-button" (click)="onExportResults()">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Export Results
        </button>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="results-content">
    <!-- Survey Question Card -->
    <div class="question-card">
      <div class="question-header">
        <h2 class="question-title">How satisfied are you?</h2>
        <div class="question-stats">
          <span class="total-responses">1,250 responses</span>
          <span class="completion-rate">78% completion rate</span>
        </div>
      </div>

      <!-- Response Options with Bar Chart -->
      <div class="response-options">
        <div class="response-option" *ngFor="let option of responseOptions; let i = index">
          <div class="option-label">{{ option.label }}</div>
          <div class="option-bar-container">
            <div class="option-bar" 
                 [style.width.%]="option.percentage"
                 [class]="'bar-' + (i + 1)">
              <span class="bar-value">{{ option.count }}</span>
            </div>
            <span class="bar-percentage">{{ option.percentage }}%</span>
          </div>
        </div>
      </div>

      <!-- Summary Stats -->
      <div class="summary-stats">
        <div class="stat-item">
          <span class="stat-label">Average Rating</span>
          <span class="stat-value">3.8/5</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Satisfaction Rate</span>
          <span class="stat-value">72%</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Response Time</span>
          <span class="stat-value">2.3 days</span>
        </div>
      </div>
    </div>

    <!-- Additional Charts -->
    <div class="charts-grid">
      <!-- Response Trend Chart -->
      <div class="chart-card">
        <div class="chart-header">
          <h3>Response Trend</h3>
          <button type="button" class="view-details-btn" (click)="onViewTrendDetails()">View Details</button>
        </div>
        <div class="chart-content">
          <div class="trend-chart">
            <div class="trend-line" *ngFor="let point of trendData; let i = index"
                 [style.left.%]="(i / (trendData.length - 1)) * 100"
                 [style.height.%]="(point.value / 100) * 100">
              <div class="trend-point"></div>
            </div>
          </div>
          <div class="trend-labels">
            <span *ngFor="let label of trendLabels">{{ label }}</span>
          </div>
        </div>
      </div>

      <!-- Demographic Breakdown -->
      <div class="chart-card">
        <div class="chart-header">
          <h3>Demographic Breakdown</h3>
          <button type="button" class="view-details-btn" (click)="onViewDemographicDetails()">View Details</button>
        </div>
        <div class="chart-content">
          <div class="demographic-chart">
            <div class="demo-item" *ngFor="let demo of demographicData">
              <div class="demo-label">{{ demo.category }}</div>
              <div class="demo-bar-container">
                <div class="demo-bar" [style.width.%]="demo.percentage"></div>
                <span class="demo-percentage">{{ demo.percentage }}%</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Comments Section -->
    <div class="comments-section">
      <div class="comments-card">
        <div class="comments-header">
          <h3>Recent Comments</h3>
          <button type="button" class="view-all-btn" (click)="onViewAllComments()">View All</button>
        </div>
        <div class="comments-list">
          <div class="comment-item" *ngFor="let comment of recentComments">
            <div class="comment-header">
              <span class="comment-rating">{{ comment.rating }}/5</span>
              <span class="comment-date">{{ comment.date }}</span>
            </div>
            <p class="comment-text">{{ comment.text }}</p>
            <div class="comment-meta">
              <span class="comment-category">{{ comment.category }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
